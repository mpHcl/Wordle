@page "/"
@page "/daily-challenge"

@inject HttpClient Http
@inject ILocalStorageService LocalStorage

@using System.Security.Cryptography
@using Client.Pages.Components.Wordle
@using Shared
@using Shared.Dtos

<PageTitle>Daily challenge</PageTitle>

<div class="container">
    <header>
        <h1>Daily challenge @DateTime.UtcNow.ToString("yyyy-MM-dd")</h1>
        <p class="sub">Guess the 5-letter word. You have <strong>6</strong> tries.</p>
    </header>

    <main>
        <WordleGame GameDto=@NewGame/>

        <footer>
            <small>Local demo — replace the in-file wordlist with server-driven daily words for production.</small>
        </footer>
    </main>
</div>

<style>
    .container {
        max-width: 720px;
        margin: 1.5rem auto;
        padding: 1rem;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto;
    }

    header {
        text-align: center;
        margin-bottom: 1rem;
    }

    
</style>

@code {
    GameDto? NewGame { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await GetNewDailyGameAsync();
    }

    async Task GetNewDailyGameAsync()
    {
        try
        {
            var token = await LocalStorage.GetItemAsync<string>("authToken");
            Http.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", token);

            NewGame = await Http.GetFromJsonAsync<GameDto>("/api/dailychallenge/game");
        }
        catch (Exception ex)
        {

        }

       
    }
}